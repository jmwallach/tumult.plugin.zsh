#!/usr/bin/env bash
#
# Helper script to print the password for a wifi network on macOS
#
# Apache licensed.
#
# Copyright 2015-2024 Joe Block <jpb@unixorn.net>
#
# This has only been tested on OS X 10.10 Yosemite since I don't have
# anything older.

function check-dependency() {
  if ! (builtin command -V "$1" >/dev/null 2>&1); then
      error "missing dependency: can't find $1 in your PATH"
      exit 1
  fi
}
check-dependency security

if [[ "$(uname -s)" = "Darwin" ]]; then
  security find-generic-password -ga "$1" 2>&1 | \
    grep 'password:' | \
    cut -c11-
else
  echo "This only works on macOS"
fi
